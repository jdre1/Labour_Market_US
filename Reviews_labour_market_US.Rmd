---
title: "Reviews_labour_market_US"
author: "Jaroslaw Dremlik"
date: "15/01/2022"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Labour market short analysis and visualisation

### 1. load packages
```{r}
library(dplyr)
library(ggplot2)
library(tidyr)
library(stringr)
```

### 2. Including Plots

Download files and upload data frame
```{r}
path <-'C:/Main_folder/Source_files/R_source_file/Labour_Market_US/'
files <- c('alldata.csv',
           'fulltimeAL.csv',
           'fulltimeAT.csv',
           'fulltimeBO.csv',
           'fulltimeBOS.csv',
           'fulltimeCHI.csv',
           'fulltimeDC.csv',
           'fulltimeLA.csv',
           'fulltimeMA.csv',
           'fulltimeMV.csv',
           'fulltimeNY.csv',
           'fulltimeRM.csv',
           'fulltimeSD.csv',
           'fulltimeSEA.csv',
           'fulltimeSF.csv',
           'fulltimeSU.csv'
           )
frame <- function(k){
  #read.csv(paste(path, files[k], sep = ''),
   #        na.strings = c('NA', 'NULL'))
  return(read.csv(paste(path, files[k], sep = ''),
                  na.strings = c('NA', 'NULL')))
}
df_all <- frame(1)
```

### Basic data frame statistical summary
```{r}
summary(df_all)
```

### Check NAs
```{r}
is.na(df_all)
```

### Excluding NAs
```{r}
df_all <- na.omit(df_all)
```

### Chgecks NAs
```{r}
sum(is.na(df_all$reviews))
```

### Plotting general view of job reviews
```{r message=TRUE, warning=TRUE}
cutting_into_breaks = cut(df_all$reviews, breaks = seq(from = 0, to = 500, by = 100))
w = table(cutting_into_breaks)
names(w) <- c('0 to 50', '100 to 150', '200 to 250', '300 to 350','400 to 450')
plot(w, ylab = 'Number of rewiews', xlab = 'aaa', col = 'blue', lwd = 3)
```

### Extracting and adding new variable City do set of data frame named City
```{r}
city_1 <- str_split_fixed(df_all$location, ',', 2)
city_1
city_2 <- city_1[,-2]
city_2
df_all$city <- city_2
```

### Extracting and adding new variable State do set of data frame named State
```{r}
state_2 <- city_1[,-1]
state_2
state_3 <- gsub(' ', '', state_2)
state_3
state_4 <- strtrim(state_3, 2)
state_4
df_all$state <- state_4
```
### Plotting average of reviews by State in the US
```{r}
aver_state_reviews <- sort(tapply(df_all$reviews, df_all$state, mean), 
                           decreasing = TRUE)
barplot(aver_state_reviews, col='lightblue', xlab = 'States in the US')
title('Average reviews per state in the US')
```
### Plotting average of reviews by company TOP-5
```{r}

company <- sort(tapply(df_all$reviews, df_all$company, mean), decreasing = TRUE)
company_top_5 <- head(company, 5)
barplot(company_top_5, col = 'pink')
title('Average reviews number by company TOP 5')

```
### Plotting average of reviews by company BOTTON-5
```{r}
company <- sort(tapply(df_all$reviews, df_all$company, mean), decreasing = FALSE)
company_bottom_5 <- head(company, 5)
barplot(company_bottom_5, col = 'brown')
title('Average reviews number by company BOTTOM 5')

```